<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Login</title>
<style>body{font-family:system-ui;margin:0}main{max-width:480px;margin:60px auto;padding:0 16px}label{display:block;margin-top:12px}input,button{padding:12px;border-radius:10px;border:1px solid #ccc;width:100%;margin-top:6px}button{background:#111;color:#fff;border-color:#111;cursor:pointer}.note{font-size:12px;opacity:.75;margin-top:8px}</style></head>
<body><main><h2>Đăng nhập ECN</h2><label>User</label><input id="u"><label>Password</label><input id="p" type="password"><label><input type="checkbox" id="rm"> Ghi nhớ</label><button id="go">Vào hệ thống</button><div id="m" class="note"></div><div class="note">U004/bao • U001/minh • U002/lan • U003/quang</div></main>
<script>
document.getElementById('go').onclick=async ()=>{const u=document.getElementById('u').value.trim(),p=document.getElementById('p').value,r=document.getElementById('rm').checked,m=document.getElementById('m');m.textContent='Đang đăng nhập...';try{const R=await fetch('auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});if(!R.ok)throw new Error('HTTP '+R.status);const d=await R.json();sessionStorage.setItem('ecn.jwt',d.accessToken);if(r)localStorage.setItem('ecn.autologin','1'); else localStorage.removeItem('ecn.autologin');location.href='ecn.html'}catch(e){m.textContent='Đăng nhập thất bại: '+(e.message||'')}};
window.addEventListener('DOMContentLoaded',async()=>{if(localStorage.getItem('ecn.autologin')==='1'){try{const t=sessionStorage.getItem('ecn.jwt');if(t){const r=await fetch('api/me',{headers:{Authorization:'Bearer '+t}});if(r.ok)location.href='ecn.html'}}catch(e){}}});
</script></body></html>